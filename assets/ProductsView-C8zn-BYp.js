import{P as C}from"./PaginationComponent-TQiU0I3V.js";import{M}from"./modal-Bsjbe5k1.js";import{_ as v,o as n,c as i,a as t,t as l,e as r,f as k,v as I,r as p,b as h,F as x,g as $,n as S,d as b}from"./index-Dvp9cMEx.js";import{L as T}from"./LoadingOverlay-CRbHZBp_.js";const A={props:["product"],data(){return{bsModal:"",qty:1}},methods:{addToCart_Modal(d,a){this.$emit("addToCart",d,a),this.qty=1}},mounted(){this.bsModal=new M(this.$refs.modal)}},E={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},V={class:"modal-dialog modal-xl",role:"document"},w={class:"modal-content border-0"},D={class:"modal-header bg-dark text-white"},L={class:"modal-title",id:"exampleModalLabel"},U=t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),N={class:"modal-body"},q={class:"row"},O={class:"col-sm-6"},R=["src"],B={class:"col-sm-6"},z={class:"badge bg-primary rounded-pill"},F={key:0,class:"h5"},j={key:1,class:"h6"},G={key:2,class:"h5"},H={class:"input-group"};function J(d,a,o,c,s,u){return n(),i("div",E,[t("div",V,[t("div",w,[t("div",D,[t("h5",L,l(o.product.title),1),U]),t("div",N,[t("div",q,[t("div",O,[t("img",{class:"img-fluid",src:o.product.imageUrl,alt:""},null,8,R)]),t("div",B,[t("span",z,l(o.product.category),1),t("p",null,"商品描述："+l(o.product.description),1),t("p",null,"商品內容："+l(o.product.content),1),o.product.price?r("",!0):(n(),i("div",F,l()+" 元",1)),o.product.price?(n(),i("del",j,"原價 "+l(o.product.origin_price)+" 元",1)):r("",!0),o.product.price?(n(),i("div",G,"現在只要 "+l(o.product.price)+" 元",1)):r("",!0),t("div",null,[t("div",H,[k(t("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":a[0]||(a[0]=_=>s.qty=_)},null,512),[[I,s.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:a[1]||(a[1]=_=>u.addToCart_Modal(o.product.id,s.qty))},"加入購物車")])])])])])])])],512)}const K=v(A,[["render",J]]),Q={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_API_NAME:"jasonfu-api-vuetest",VITE_APP_API_URL:"https://ec-course-api.hexschool.io/v2"},{VITE_APP_API_URL:g,VITE_APP_API_NAME:m}=Q,W={components:{PaginationComponent:C,UserProductModal:K,LoadingOverlay:T},data(){return{products:[],productDetail:{},pagination:{},cart:{carts:[]},loadingStatus:{loadingItem:""},loadingComponent:!0}},methods:{renderProducts(d=1){const a=`${g}/api/${m}/products?page=${d}`;this.$http.get(a).then(o=>{this.products=o.data.products,this.pagination=o.data.pagination,this.loadingComponent=!1}).catch(o=>{alert(o.response.data.message)})},viewDetail(d){if(this.loadingStatus.loadingItem=d,this.$refs.productModal.qty=1,this.products.find(o=>o.id===d)){const o=`${g}/api/${m}/product/${d}`;this.$http.get(o).then(c=>{this.productDetail=c.data.product,this.loadingStatus.loadingItem="",this.$refs.productModal.bsModal.show()}).catch(c=>{alert(c.response.data.message)})}},addToCart(d,a=1){if(a<=0){alert("數量必須大於0");return}this.loadingStatus.loadingItem=d;const o={product_id:d,qty:a},c=`${g}/api/${m}/cart`;this.$http.post(c,{data:o}).then(s=>{alert(s.data.message),this.loadingStatus.loadingItem="",this.$refs.productModal.bsModal.hide()}).catch(s=>{alert(s.response.data.message)})}},mounted(){this.renderProducts()}},X={class:"container"},Y={class:"mt-4"},Z={class:"table align-middle"},tt=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),ot={style:{width:"200px"}},et={key:0,class:"h5"},st={key:1,class:"h6"},at={key:2,class:"h5"},dt={class:"btn-group btn-group-sm"},nt=["onClick","disabled"],it={key:0,class:"fas fa-spinner fa-pulse"},lt=["onClick","disabled"],rt={key:0,class:"fas fa-spinner fa-pulse"};function ct(d,a,o,c,s,u){const _=p("LoadingOverlay"),f=p("user-Product-Modal"),y=p("PaginationComponent");return n(),i("div",X,[h(_,{active:s.loadingComponent,"onUpdate:active":a[0]||(a[0]=e=>s.loadingComponent=e),"is-full-page":!0},null,8,["active"]),t("div",Y,[h(f,{ref:"productModal",product:s.productDetail,onAddToCart:u.addToCart},null,8,["product","onAddToCart"]),t("table",Z,[tt,t("tbody",null,[(n(!0),i(x,null,$(s.products,e=>(n(),i("tr",{key:e.id},[t("td",ot,[t("div",{style:S([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${e.imageUrl})`}])},null,4)]),t("td",null,l(e.title),1),t("td",null,[e.price?r("",!0):(n(),i("div",et,l(e.origin_price)+" 元",1)),e.price?(n(),i("del",st,"原價 "+l(e.origin_price)+" 元",1)):r("",!0),e.price?(n(),i("div",at,"現在只要 "+l(e.price)+" 元",1)):r("",!0)]),t("td",null,[t("div",dt,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:P=>u.viewDetail(e.id),disabled:s.loadingStatus.loadingItem===e.id||!e.is_enabled},[s.loadingStatus.loadingItem===e.id?(n(),i("i",it)):r("",!0),b(" 查看更多 ")],8,nt),t("button",{type:"button",class:"btn btn-outline-danger",onClick:P=>u.addToCart(e.id),disabled:s.loadingStatus.loadingItem===e.id||!e.is_enabled},[s.loadingStatus.loadingItem===e.id?(n(),i("i",rt)):r("",!0),b(" 加到購物車 ")],8,lt)])])]))),128))])]),h(y,{pages:s.pagination,onEmitPages:u.renderProducts},null,8,["pages","onEmitPages"])])])}const gt=v(W,[["render",ct]]);export{gt as default};
